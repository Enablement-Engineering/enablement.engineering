---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
	const ladderEntries = await getCollection('ladders');
	return ladderEntries.map(entry => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

// Format date for display
const publishedDate = entry.data.publishedAt.toLocaleDateString('en-US', {
	year: 'numeric',
	month: 'long',
	day: 'numeric',
});

const updatedDate = entry.data.updatedAt?.toLocaleDateString('en-US', {
	year: 'numeric',
	month: 'long',
	day: 'numeric',
});
---

<Layout title={`${entry.data.title} | Ladders | Enablement Engineering`} description={entry.data.description}>
	<article class="py-16 lg:py-24">
		<div class="max-w-3xl mx-auto">
			<!-- Header -->
			<header class="mb-12">
				<a href="/" class="inline-flex items-center text-neutral-500 hover:text-neutral-700 mb-6 group">
					<svg class="w-5 h-5 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18" />
					</svg>
					Back to Home
				</a>

				<div class="mb-4 flex items-center gap-3">
					<span class="inline-block px-3 py-1 text-sm font-medium rounded-full bg-secondary-100 text-secondary-700">
						Ladder
					</span>
					{entry.data.featured && (
						<span class="inline-block px-3 py-1 text-sm font-medium rounded-full bg-primary-100 text-primary-700">
							Featured
						</span>
					)}
				</div>

				<h1 class="text-3xl lg:text-4xl font-bold text-ink mb-4 leading-tight">
					{entry.data.title}
				</h1>

				<p class="text-xl text-neutral-600 mb-6">
					{entry.data.description}
				</p>

				<div class="text-sm text-neutral-500">
					<span>Published {publishedDate}</span>
					{updatedDate && (
						<span class="ml-4">Updated {updatedDate}</span>
					)}
				</div>
			</header>

			<!-- Capabilities Section -->
			<section class="mb-12 p-6 bg-secondary-50 rounded-xl border border-secondary-200">
				<h2 class="text-lg font-semibold text-ink mb-4 flex items-center gap-2">
					<svg class="w-5 h-5 text-secondary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
					Capabilities
				</h2>
				<ul class="space-y-2">
					{entry.data.capabilities.map((capability) => (
						<li class="flex items-start gap-3">
							<svg class="w-5 h-5 text-primary-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
							</svg>
							<span class="text-neutral-700">{capability}</span>
						</li>
					))}
				</ul>
			</section>

			<!-- Tags -->
			{entry.data.tags && entry.data.tags.length > 0 && (
				<div class="mb-8">
					<div class="flex flex-wrap gap-2">
						{entry.data.tags.map((tag) => (
							<span class="px-3 py-1 bg-neutral-100 text-neutral-600 text-sm rounded-full">
								{tag}
							</span>
						))}
					</div>
				</div>
			)}

			<!-- Content -->
			<div class="prose prose-lg prose-neutral max-w-none
				prose-headings:text-ink prose-headings:font-bold
				prose-h2:text-2xl prose-h2:mt-12 prose-h2:mb-4
				prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3
				prose-p:text-neutral-700 prose-p:leading-relaxed
				prose-a:text-link-600 prose-a:underline prose-a:decoration-link/50 prose-a:underline-offset-2 hover:prose-a:decoration-link
				prose-strong:text-ink
				prose-em:text-neutral-700
				prose-code:bg-neutral-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono
				prose-pre:bg-secondary-900 prose-pre:text-neutral-100 prose-pre:overflow-x-auto
				prose-blockquote:border-l-primary-400 prose-blockquote:bg-neutral-50 prose-blockquote:py-1 prose-blockquote:px-4 prose-blockquote:rounded-r-lg prose-blockquote:not-italic
				prose-ul:list-disc prose-ul:pl-6
				prose-ol:list-decimal prose-ol:pl-6
				prose-li:text-neutral-700
				prose-hr:border-neutral-200
			">
				<Content />
			</div>

			<!-- CTA -->
			<div class="mt-12 p-8 bg-neutral-50 rounded-2xl">
				<h2 class="text-xl font-bold text-ink mb-4">
					Ready to build this capability?
				</h2>
				<p class="text-neutral-600 mb-6">
					Let's discuss how to implement this ladder in your organization.
				</p>
				<div class="flex flex-col sm:flex-row gap-4">
					<a href="/approach" class="inline-flex items-center justify-center whitespace-nowrap rounded-lg font-semibold bg-primary-400 text-secondary-900 hover:bg-primary-300 h-11 px-6 no-underline text-sm">
						Our Approach
					</a>
					<a href="/services" class="inline-flex items-center justify-center whitespace-nowrap rounded-lg font-semibold bg-secondary-900 text-neutral-50 hover:bg-secondary-800 h-11 px-6 no-underline text-sm">
						View Services
					</a>
				</div>
			</div>
		</div>
	</article>
</Layout>
